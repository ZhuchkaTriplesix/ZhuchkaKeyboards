# ZhuchkaKeyboards ๐น

ะกะธััะตะผะฐ ัะฟัะฐะฒะปะตะฝะธั ะฟัะพะธะทะฒะพะดััะฒะพะผ ะธ ะฟัะพะดะฐะถะฐะผะธ ะบะปะฐะฒะธะฐััั ั ะฒะตะฑ-ะธะฝัะตััะตะนัะพะผ, API, ะฑะพัะพะผ ะธ GUI-ะฟัะธะปะพะถะตะฝะธะตะผ.

---

## ๐๏ธ ะััะธัะตะบัััะฐ

- **Gateway** โ FastAPI ัะตัะฒะธั (src)
- **Database** โ PostgreSQL (docker-compose)
- **Cache** โ Redis (docker-compose)
<<<<<<< HEAD
- **Monitoring** โ Prometheus + Grafana + Loki (docker-compose)
=======
>>>>>>> performance-optimizations
- **Alembic** โ ะผะธะณัะฐัะธะธ ะฒ `src/database/alembic`
- **API** โ REST API
- **Bot** โ Telegram ะฑะพั
- **GUI** โ ะะตัะบัะพะฟะฝะพะต ะฟัะธะปะพะถะตะฝะธะต

---

## ๐ ะัััััะน ััะฐัั

### ะัะตะดะฒะฐัะธัะตะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั
- Docker ะธ Docker Compose
- Python 3.11+
- Git

### ะะฐะฟััะบ ัะตัะตะท Docker Compose

```bash
git clone <repository-url>
cd ZhuchkaKeyboards
<<<<<<< HEAD

# ะะฐะฟััะบ ัะฐะทัะฐะฑะพัะบะธ
make dev

# ะะปะธ ะทะฐะฟััะบ ั ะผะพะฝะธัะพัะธะฝะณะพะผ
make dev
make monitoring
```

### ะะพัััะฟะฝัะต ัะตัะฒะธัั

- **Gateway API**: http://localhost:8001
- **PostgreSQL**: localhost:5432
- **Redis**: localhost:6379
- **Grafana**: http://localhost:3000 (admin/admin123)
- **Prometheus**: http://localhost:9090
- **Loki**: http://localhost:3100
=======
docker-compose up --build
```

- Gateway API: http://localhost:8001
- PostgreSQL: localhost:5432
- Redis: localhost:6379
>>>>>>> performance-optimizations

---

## ๐ฆ ะะธะณัะฐัะธะธ Alembic

ะะธะณัะฐัะธะธ ะธ ะบะพะฝัะธะณ Alembic ะฝะฐัะพะดัััั ะฒ `gateway/src/database/alembic` ะธ `gateway/src/database/alembic.ini`.

### ะะตะฝะตัะฐัะธั ะฝะพะฒะพะน ะผะธะณัะฐัะธะธ
```bash
docker-compose exec gateway bash -c "cd /app/src/database && alembic revision --autogenerate -m 'ะพะฟะธัะฐะฝะธะต'"
```

### ะัะธะผะตะฝะตะฝะธะต ะผะธะณัะฐัะธะน
```bash
docker-compose exec gateway bash -c "cd /app/src/database && alembic upgrade head"
```

### ะัะบะฐั ะผะธะณัะฐัะธะธ
```bash
docker-compose exec gateway bash -c "cd /app/src/database && alembic downgrade -1"
```

### ะกัััะบัััะฐ Alembic
```
gateway/
โโโ src/
    โโโ database/
        โโโ alembic.ini
        โโโ alembic/
            โโโ env.py
            โโโ script.py.mako
            โโโ versions/
```

---

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
ZhuchkaKeyboards/
โโโ README.md
โโโ docker-compose.yaml
โโโ docker-compose.local.yml
โโโ Makefile
โโโ main.py
โโโ requirements.txt
โโโ LICENSE
โโโ gateway/
โ   โโโ requirements.txt
โ   โโโ Dockerfile
โ   โโโ src/
โ       โโโ config.py
โ       โโโ main.py
โ       โโโ main_schemas.py
โ       โโโ dependencies.py
โ       โโโ pydantic_config.py
โ       โโโ configuration/
โ       โ   โโโ app.py
โ       โโโ database/
โ       โ   โโโ alembic.ini
โ       โ   โโโ core.py
โ       โ   โโโ logging.py
โ       โ   โโโ dependencies.py
โ       โ   โโโ alembic/
โ       โ       โโโ env.py
โ       โ       โโโ script.py.mako
โ       โ       โโโ versions/
โ       โ           โโโ __init__.py
โ       โโโ routers/
โ       โ   โโโ __init__.py
โ       โ   โโโ user/
โ       โ       โโโ actions.py
โ       โ       โโโ dal.py
โ       โ       โโโ models.py
โ       โ       โโโ router.py
โ       โ       โโโ schemas.py
โ       โ       โโโ __init__.py
โ       โโโ security/
โ       โ   โโโ hashing.py
|       |   โโโ security.py
โ       โโโ services/
โ       โ   โโโ redis/
โ       โ       โโโ rediska.py
โ       โโโ utils/
โ       โ   โโโ logger.py
โ       โ   โโโ responses_schemas.py
โ       โ   โโโ responses.py
|       |   โโโ __init__.py
โโโ .github/
```

---

## โก ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

### ะะฟัะธะผะธะทะฐัะธั JSON
- **orjson**: ะัะฟะพะปัะทัะตััั ะดะปั ะฒััะพะบะพะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพะน ัะตัะธะฐะปะธะทะฐัะธะธ/ะดะตัะตัะธะฐะปะธะทะฐัะธะธ JSON
- **Pydantic + orjson**: ะัะต Pydantic ะผะพะดะตะปะธ ะฝะฐัััะพะตะฝั ะดะปั ะธัะฟะพะปัะทะพะฒะฐะฝะธั orjson
- **FastAPI ORJSONResponse**: API ะพัะฒะตัั ะธัะฟะพะปัะทััั orjson ะฟะพ ัะผะพะปัะฐะฝะธั

### ะัะตะธะผััะตััะฒะฐ orjson
- ะ 2-3 ัะฐะทะฐ ะฑััััะตะต ััะฐะฝะดะฐััะฝะพะณะพ `json` ะผะพะดัะปั
- ะะพะดะดะตัะถะบะฐ numpy ะผะฐััะธะฒะพะฒ ะธ datetime ะพะฑัะตะบัะพะฒ
- ะะพะปะตะต ัััะพะณะฐั ะฒะฐะปะธะดะฐัะธั JSON
- ะะตะฝััะต ะฟะพััะตะฑะปะตะฝะธะต ะฟะฐะผััะธ

---

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

| ะะตัะตะผะตะฝะฝะฐั | ะะฟะธัะฐะฝะธะต | ะะพ ัะผะพะปัะฐะฝะธั |
|------------|----------|--------------|
| `POSTGRES_HOST` | ะฅะพัั PostgreSQL | `localhost` |
| `POSTGRES_PORT` | ะะพัั PostgreSQL | `5432` |
| `POSTGRES_USER` | ะะพะปัะทะพะฒะฐัะตะปั ะะ | `postgres` |
| `POSTGRES_PASSWORD` | ะะฐัะพะปั ะะ | `password` |
| `POSTGRES_DB` | ะะผั ะฑะฐะทั ะดะฐะฝะฝัั | `postgres` |
| `REDIS_HOST` | ะฅะพัั Redis | `localhost` |
| `REDIS_PORT` | ะะพัั Redis | `6379` |
| `JWT_SECRET` | ะกะตะบัะตัะฝัะน ะบะปัั JWT | ะะตะฝะตัะธััะตััั |
| `JWT_ALGORITHM` | ะะปะณะพัะธัะผ JWT | `HS256` |
| `ACCESS_TOKEN_EXPIRE_MINUTES` | ะัะตะผั ะถะธะทะฝะธ ัะพะบะตะฝะฐ | `11520` |

---

## ๐๏ธ ะะฐะทัะฐะฑะพัะบะฐ

### ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

```bash
# Gateway
cd gateway
pip install -r requirements.txt

# API
cd ../api
pip install -r requirements.txt
```

### ะะฐะฟััะบ ะฒ ัะตะถะธะผะต ัะฐะทัะฐะฑะพัะบะธ

```bash
# Gateway
cd gateway/src
uvicorn main:app --reload --port 8001

# API
cd ../../api
uvicorn main:app --reload --port 8000
```

### ะขะตััะธัะพะฒะฐะฝะธะต

```bash
pytest
mypy .
flake8 .
```

### ะขะตััะธัะพะฒะฐะฝะธะต ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ orjson

```bash
# ะขะตัั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ orjson
cd gateway
python test_orjson.py

# ะขะตัั ะฒ Docker ะบะพะฝัะตะนะฝะตัะต
docker-compose exec gateway python test_orjson.py
```

---

<<<<<<< HEAD
## ๐ ะะพะฝะธัะพัะธะฝะณ ะธ ะะตััะธะบะธ

### ะกัะตะบ ะผะพะฝะธัะพัะธะฝะณะฐ

- **Prometheus** - ัะฑะพั ะธ ััะฐะฝะตะฝะธะต ะผะตััะธะบ
- **Grafana** - ะฒะธะทัะฐะปะธะทะฐัะธั ะธ ะดะฐัะฑะพัะดั  
- **Loki** - ะฐะณัะตะณะฐัะธั ะปะพะณะพะฒ
- **Promtail** - ะพัะฟัะฐะฒะบะฐ ะปะพะณะพะฒ
- **Exporters** - ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ะผะตััะธะบะธ (PostgreSQL, Redis, Node)

### ะะฐะฟััะบ ะผะพะฝะธัะพัะธะฝะณะฐ

```bash
# ะะฐะฟััะบ ะพัะฝะพะฒะฝะพะณะพ ะฟัะธะปะพะถะตะฝะธั
make dev

# ะะฐะฟััะบ ััะตะบะฐ ะผะพะฝะธัะพัะธะฝะณะฐ
make monitoring
```

### ะะพัััะฟ ะบ ะธะฝัะตััะตะนัะฐะผ

- **Grafana**: http://localhost:3000
  - ะะพะปัะทะพะฒะฐัะตะปั: `admin`
  - ะะฐัะพะปั: `admin123`
- **Prometheus**: http://localhost:9090
- **Loki**: http://localhost:3100

### ๐ฅ HTTP ะะตััะธะบะธ (NEW!)

ะะตัะฐะปัะฝะพะต ะพััะปะตะถะธะฒะฐะฝะธะต API ะทะฐะฟัะพัะพะฒ:

- **Request Rate** - ะบะพะปะธัะตััะฒะพ ะทะฐะฟัะพัะพะฒ ะฒ ัะตะบัะฝะดั
- **Response Time** - ะฒัะตะผั ะพัะฒะตัะฐ (ััะตะดะฝ., 95%, 99%)  
- **Error Rate** - ะฟัะพัะตะฝั ะพัะธะฑะพะบ
- **Status Codes** - ัะฐัะฟัะตะดะตะปะตะฝะธะต ะฟะพ ะบะพะดะฐะผ ะพัะฒะตัะฐ
- **User Agents** - ะฐะฝะฐะปะธะท ะบะปะธะตะฝัะพะฒ (ะฑัะฐัะทะตัั, curl, etc.)
- **Request/Response Sizes** - ัะฐะทะผะตัั ะดะฐะฝะฝัั
- **Slow Requests** - ะผะตะดะปะตะฝะฝัะต ะทะฐะฟัะพัั (>1s)
- **IP Tracking** - ะทะฐะฟัะพัั ะฟะพ IP ะฐะดัะตัะฐะผ

#### ะญะฝะดะฟะพะธะฝัั ะผะตััะธะบ:
```bash
# ะะตัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั ะพ HTTP ะผะตััะธะบะฐั
curl http://localhost:8001/api/metrics/http

# ะัะฐัะบะฐั ัะฒะพะดะบะฐ ะฒัะตั ะผะตััะธะบ  
curl http://localhost:8001/api/metrics-summary

# ะัะต ะผะตััะธะบะธ Prometheus
curl http://localhost:8001/metrics
```

### Dashboards ะฒ Grafana

1. **ZhuchkaKeyboards - Application Overview** - ะพัะฝะพะฒะฝะฐั ะฟะฐะฝะตะปั ะผะพะฝะธัะพัะธะฝะณะฐ
2. **HTTP Metrics Dashboard** - ะดะตัะฐะปัะฝะฐั ะฐะฝะฐะปะธัะธะบะฐ HTTP ะทะฐะฟัะพัะพะฒ

### ะกะพะฑะธัะฐะตะผัะต ะผะตััะธะบะธ

#### ะะตััะธะบะธ ะฟัะธะปะพะถะตะฝะธั
- HTTP ะทะฐะฟัะพัั (ะบะพะปะธัะตััะฒะพ, ะฒัะตะผั ะพัะฒะตัะฐ, ััะฐััั ะบะพะดั)
- ะะฐะทะฐ ะดะฐะฝะฝัั (ะฒัะตะผั ะฒัะฟะพะปะฝะตะฝะธั ะทะฐะฟัะพัะพะฒ, ะบะพะปะธัะตััะฒะพ ัะพะตะดะธะฝะตะฝะธะน)
- Redis (ะพะฟะตัะฐัะธะธ, ัะฐะทะผะตั ะฟัะปะฐ ัะพะตะดะธะฝะตะฝะธะน)
- ะะธะทะฝะตั-ะปะพะณะธะบะฐ (ะทะฐะบะฐะทั, ะทะฐะดะฐัะธ ะฟัะพะธะทะฒะพะดััะฒะฐ, ะฟัะพะฒะตัะบะธ ะบะฐัะตััะฒะฐ)
- ะัะธะฑะบะธ ะฟัะธะปะพะถะตะฝะธั
- ะะตัะธัะพะฒะฐะฝะธะต (hit/miss ratio)

#### ะะตััะธะบะธ ะธะฝััะฐััััะบัััั
- PostgreSQL (ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั ะะ, ัะพะตะดะธะฝะตะฝะธั, ะทะฐะฟัะพัั)
- Redis (ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะฟะฐะผััะธ, ะพะฟะตัะฐัะธะธ, ะบะปะธะตะฝัั)
- ะกะธััะตะผะฐ (CPU, ะฟะฐะผััั, ะดะธัะบ, ัะตัั)

### ะะพัะพะฒัะต ะดะฐัะฑะพัะดั

1. **ZhuchkaKeyboards Overview**
   - ะะฑะทะพั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ ะฟัะธะปะพะถะตะฝะธั
   - HTTP ะผะตััะธะบะธ ะธ ัะฐััะพัะฐ ะพัะธะฑะพะบ
   - ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั ะะ ะธ Redis
   - ะะธะทะฝะตั-ะผะตััะธะบะธ (ะทะฐะบะฐะทั, ะฟัะพะธะทะฒะพะดััะฒะพ)

### ะัะพะฒะตัะบะฐ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ

```bash
# ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั ะฒัะตั ัะตัะฒะธัะพะฒ
make health

# ะัะพัะผะพัั ะผะตััะธะบ
make metrics

# ะะพะณะธ ัะตัะฒะธัะพะฒ
make logs
```

ะะพะดัะพะฑะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะฟะพ ะผะพะฝะธัะพัะธะฝะณั: [monitoring/README.md](monitoring/README.md)

---

=======
>>>>>>> performance-optimizations
## ๐ ะะตะทะพะฟะฐัะฝะพััั
- JWT ัะพะบะตะฝั ะดะปั ะฐััะตะฝัะธัะธะบะฐัะธะธ
- ะฅะตัะธัะพะฒะฐะฝะธะต ะฟะฐัะพะปะตะน ั bcrypt
- CORS ะฝะฐัััะพะนะบะธ
- Rate limiting
- ะะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั ัะตัะตะท Pydantic
- ะััะพะบะพะฟัะพะธะทะฒะพะดะธัะตะปัะฝะฐั ัะตัะธะฐะปะธะทะฐัะธั JSON ัะตัะตะท orjson

---

## ๐ API ะะพะบัะผะตะฝัะฐัะธั
- **Swagger UI**: http://localhost:8001/api/docs
- **ReDoc**: http://localhost:8001/api/redoc
- **OpenAPI JSON**: http://localhost:8001/api/openapi.json

---

## ๐ณ Docker

### ะกะฑะพัะบะฐ ะธ ะทะฐะฟััะบ
```bash
docker-compose up --build
```

### ะะตะฝะตัะฐัะธั ะธ ะฟัะธะผะตะฝะตะฝะธะต ะผะธะณัะฐัะธะน (ะฒ ะบะพะฝัะตะนะฝะตัะต)
```bash
docker-compose exec gateway bash -c "cd /app/src/database && alembic revision --autogenerate -m 'ะพะฟะธัะฐะฝะธะต'"
docker-compose exec gateway bash -c "cd /app/src/database && alembic upgrade head"
```

---

## ๐ค ะะบะปะฐะด ะฒ ะฟัะพะตะบั
1. ะคะพัะบะฝะธัะต ัะตะฟะพะทะธัะพัะธะน
2. ะกะพะทะดะฐะนัะต ะฒะตัะบั ะดะปั ะฝะพะฒะพะน ััะฝะบัะธะธ
3. ะะฝะตัะธัะต ะธะทะผะตะฝะตะฝะธั
4. ะะพะฑะฐะฒััะต ัะตััั
5. ะกะพะทะดะฐะนัะต Pull Request

---

## ๐ ะะธัะตะฝะทะธั
ะญัะพั ะฟัะพะตะบั ะปะธัะตะฝะทะธัะพะฒะฐะฝ ะฟะพะด MIT License.

---

## ๐ ะะพะดะดะตัะถะบะฐ
ะัะปะธ ั ะฒะฐั ะตััั ะฒะพะฟัะพัั ะธะปะธ ะฟัะพะฑะปะตะผั:
1. ะกะพะทะดะฐะนัะต Issue ะฒ GitHub
2. ะะฟะธัะธัะต ะฟัะพะฑะปะตะผั ะฟะพะดัะพะฑะฝะพ
3. ะัะธะปะพะถะธัะต ะปะพะณะธ ะธ ะบะพะฝัะธะณััะฐัะธั

---

**ZhuchkaKeyboards** โ ะกะธััะตะผะฐ ัะฟัะฐะฒะปะตะฝะธั ะฟัะพะธะทะฒะพะดััะฒะพะผ ะบะปะฐะฒะธะฐััั ๐น
